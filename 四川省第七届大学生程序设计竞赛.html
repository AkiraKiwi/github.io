<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>四川省第七届大学生程序设计竞赛</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <!-- highlight.js -->
    <link media="all" rel="stylesheet" type="text/css"  href="/assets/built/rouge.css" type="text/css">
    <style>pre{background: rgba(0, 0, 0, 0.95);}</style>    
    <!-- <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style> -->
    <!-- Mathjax -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
        }
    });
    </script>
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="The personal publishing platform" />
    <link rel="shortcut icon" href="http://localhost:4000//assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="http://localhost:4000/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="drone - 以终为始，慎终如始。" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="四川省第七届大学生程序设计竞赛" />
    <meta property="og:description" content="Contest Information source: It’s from the Vjudge Problem C 给出一个禁止串和一个原串，要求从原串中不断删除禁止串，然后输出删除后的新串。 数据范围：$ length ≤ 5\times 10^{6}$ Solution 先求出禁止串的 $next$ 数组，然后在 $KMP$ 的匹配过程中，同时开一个答案串同步存储，开一个数组保存答案串和禁止串的匹配情况，并且维护它俩的长度。如果某次匹配到了禁止串末尾，那么回退禁止串长度，同时更新当前匹配位置。 AC code char no[MaxN]; char str[MaxN]; int Next[MaxN]; void makeNext(const char *P,int *next) { int q,k; int m = strlen(P); next[0] = 0; for (q = 1,k = 0;" />
    <meta property="og:url" content="http://localhost:4000/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B" />
    <meta property="og:image" content="http://localhost:4000/assets/images/stock/images-stock-photo-124520439.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/username" />
    <meta property="article:author" content="https://www.facebook.com/username" />
    <meta property="article:published_time" content="2017-07-31T07:59:59+08:00" />
    <meta property="article:modified_time" content="2017-07-31T07:59:59+08:00" />
    <meta property="article:tag" content="Algorithm" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="四川省第七届大学生程序设计竞赛" />
    <meta name="twitter:description" content="Contest Information source: It’s from the Vjudge Problem C 给出一个禁止串和一个原串，要求从原串中不断删除禁止串，然后输出删除后的新串。 数据范围：$ length ≤ 5\times 10^{6}$ Solution 先求出禁止串的 $next$ 数组，然后在 $KMP$ 的匹配过程中，同时开一个答案串同步存储，开一个数组保存答案串和禁止串的匹配情况，并且维护它俩的长度。如果某次匹配到了禁止串末尾，那么回退禁止串长度，同时更新当前匹配位置。 AC code char no[MaxN]; char str[MaxN]; int Next[MaxN]; void makeNext(const char *P,int *next) { int q,k; int m = strlen(P); next[0] = 0; for (q = 1,k = 0;" />
    <meta name="twitter:url" content="http://localhost:4000/" />
    <meta name="twitter:image" content="http://localhost:4000/assets/images/stock/images-stock-photo-124520439.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="drone - 以终为始，慎终如始。" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Algorithm" />
    <meta name="twitter:site" content="@username" />
    <meta name="twitter:creator" content="@username" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "drone - 以终为始，慎终如始。",
        "logo": "http://localhost:4000/assets/images/blog-icon.png"
    },
    "url": "http://localhost:4000/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:4000/assets/images/stock/images-stock-photo-124520439.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B"
    },
    "description": "Contest Information source: It’s from the Vjudge Problem C 给出一个禁止串和一个原串，要求从原串中不断删除禁止串，然后输出删除后的新串。 数据范围：$ length ≤ 5\times 10^{6}$ Solution 先求出禁止串的 $next$ 数组，然后在 $KMP$ 的匹配过程中，同时开一个答案串同步存储，开一个数组保存答案串和禁止串的匹配情况，并且维护它俩的长度。如果某次匹配到了禁止串末尾，那么回退禁止串长度，同时更新当前匹配位置。 AC code char no[MaxN]; char str[MaxN]; int Next[MaxN]; void makeNext(const char *P,int *next) { int q,k; int m = strlen(P); next[0] = 0; for (q = 1,k = 0;"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="四川省第七届大学生程序设计竞赛" href="/feed.xml" />

    

</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="http://localhost:4000/"><img src="/assets/images/blog-icon.png" alt="drone - 以终为始，慎终如始。" /></a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-getting-started" role="menuitem"><a href="/tag/getting-started/">Getting Started</a></li>
    <li class="nav-guide" role="menuitem"><a href="/tag/guide/">Guide</a></li>
    <li class="nav-algorithm" role="menuitem"><a href="/tag/algorithm/">Algorithm</a></li> 
    <li class="nav-algorithm" role="menuitem"><a href="/tag/drone/">Drone</a></li>     
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
                <a class="social-link social-link-fb" href="https://facebook.com/username" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
</a>
            
            
                <a class="social-link social-link-tw" href="https://twitter.com/username" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">Subscribe</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="30 July 2017">30 July 2017</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/algorithm/'>ALGORITHM</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">四川省第七届大学生程序设计竞赛</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/stock/images-stock-photo-124520439.jpg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <h2 id="contest-information">Contest Information</h2>

<p>source: <a href="https://vjudge.net/contest/158680#overview">It’s from the Vjudge</a></p>

<h2 id="problem-c">Problem C</h2>

<p>给出一个禁止串和一个原串，要求从原串中不断删除禁止串，然后输出删除后的新串。<br /></p>

<p>数据范围：$ length ≤ 5\times 10^{6}$ <br /></p>

<h2 id="solution">Solution</h2>

<p>先求出禁止串的 $next$ 数组，然后在 $KMP$ 的匹配过程中，同时开一个答案串同步存储，开一个数组保存答案串和禁止串的匹配情况，并且维护它俩的长度。如果某次匹配到了禁止串末尾，那么回退禁止串长度，同时更新当前匹配位置。<br /></p>

<h2 id="ac-code">AC code</h2>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="kt">char</span> <span class="n">no</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">str</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">Next</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">makeNext</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">next</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">q</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
    <span class="n">next</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">q</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">q</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">while</span><span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">P</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">!=</span> <span class="n">P</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">k</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">next</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">match</span><span class="p">[</span><span class="n">MaxN</span><span class="p">],</span><span class="n">top</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">ans</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">kmp</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">T</span><span class="p">,</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="kt">int</span> <span class="o">*</span><span class="n">next</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span><span class="p">,</span><span class="n">q</span><span class="p">;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">P</span><span class="p">);</span>
    <span class="n">makeNext</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">next</span><span class="p">);</span>
    <span class="n">top</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">q</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">while</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">P</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">!=</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">next</span><span class="p">[</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">==</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="n">q</span><span class="o">++</span><span class="p">;</span>  
        <span class="p">}</span>
        <span class="n">match</span><span class="p">[</span><span class="o">++</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="n">q</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">q</span> <span class="o">==</span> <span class="n">m</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">top</span> <span class="o">-=</span> <span class="n">m</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">top</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">else</span> <span class="n">q</span> <span class="o">=</span> <span class="n">match</span><span class="p">[</span><span class="n">top</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">ans</span><span class="p">[</span><span class="n">top</span><span class="p">]</span> <span class="o">=</span> <span class="sc">'\0'</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">kmp</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="n">no</span><span class="p">,</span><span class="n">Next</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%s</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%s%s"</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">str</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">solve</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="problem-d">Problem D</h2>

<p>给出一个 $n$ 个点，$m$ 条边的无向图，求最小点覆盖 <br /></p>

<p>数据范围：$ 1 ≤ n ≤ 500, 1 ≤ m ≤ \frac{n(n-1)}{2}, min(u,v) ≤ 30 $ <br /></p>

<h2 id="solution-1">Solution</h2>

<p>无向图的最小点覆盖本是NPC问题，但是本题中因为 $min(u,v) ≤ 30 $ ，所以图中的每条边都和 $30$ 以内的点相连，那么我们只需要枚举这些点的染色状态就能求出覆盖所有边的最小点集了。<br /></p>

<p>从第一个点开始 $DFS$ ：如果当前点被染色过，那么和它相连的边必然被覆盖，走下一个点；如果未被染色，我们枚举将它染色和不将它染色（需要将和它相邻的点都染色以确保覆盖掉它的边）两种情况，再走下一个点。每次回溯时记得恢复现场，使用最优化剪枝可以快速求解。</p>

<h2 id="ac-code-1">AC code</h2>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="kt">int</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">Edge</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">next</span><span class="p">;</span>
<span class="p">}</span><span class="n">edge</span><span class="p">[</span><span class="n">MaxM</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">cont</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
    <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
    <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
    <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">cont</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">vis</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">ans</span><span class="p">,</span><span class="n">tot</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">DFS</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sum</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">sum</span><span class="o">&gt;</span><span class="n">ans</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">&gt;</span><span class="n">tot</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">sum</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">])</span> <span class="n">DFS</span><span class="p">(</span><span class="n">u</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">sum</span><span class="p">);</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="n">DFS</span><span class="p">(</span><span class="n">u</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">sum</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
        <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">i</span><span class="o">!=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="n">sum</span><span class="o">++</span><span class="p">;</span>
            <span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">DFS</span><span class="p">(</span><span class="n">u</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">sum</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">i</span><span class="o">!=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
        <span class="p">{</span>           
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
            <span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">sum</span><span class="o">--</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">solve</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
    <span class="n">tot</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="mi">30</span><span class="p">);</span>
    <span class="n">CLR</span><span class="p">(</span><span class="n">vis</span><span class="p">);</span>
    <span class="n">DFS</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">init</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">MST</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">N</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">M</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">init</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">M</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">);</span>
            <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span><span class="n">add</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">solve</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="problem-f">Problem F</h2>

<p>给出一串项链，上面有 $n$ 个珠子，每个珠子有其价值 $a_{1…n}$，要求删除一些珠子使得其满足：<br /></p>

<ol>
  <li>
    <p>整串项链只有一个价值为 $10000$ 的珠子，称为完美珠子。<br /></p>
  </li>
  <li>
    <p>完美珠子的后面开始是一串价值组成不上升序列的珠子 <br /></p>
  </li>
  <li>
    <p>完美珠子的前面开始是一串价值组成不下降序列的珠子<br /></p>
  </li>
</ol>

<p>要求求出满足要求的项链的最大价值和 <br /></p>

<p>数据范围：$ 1 ≤ n ≤ 10^5, 0 ≤ m ≤ 10^4, 1 ≤ num_{10000} ≤ 10$ <br /></p>

<h2 id="solution-2">Solution</h2>

<p>首先枚举完美珠子的位置，那么问题就转化为在这个位置后求一个不上升子序列与一个不下降子序列使得它们的和最大。<br /></p>

<p>我们可以先分别求出在完美珠子之后每一个位置的和最大的非降子序列和非升子序列，然后枚举连接点就可以求出答案。
而求一个和最大的非升（降）子序列，我们可以类比 $LDS$ 的做法：它是对于每一个位置找到在它之前第一个大于它的位置以保证长度最大。
那么求和最大的非升子序列，我们就可以对于每一个位置找到在它之前的大于等于它的和最大的位置。<br /></p>

<p>那么问题又转换为：怎么快速 $(O(logn))$ 找到在某一个位置之前的大于等于它的和最大的位置？<br /></p>

<p>我们可以使用树状数组来维护：<br /></p>

<ul>
  <li>
    <p>树状数组的下标 $1…i$ 对应原序列中的值域 $[0, max(a_{1..n})]$。不过是最大值 $max(a_{1..n})$ 对应前面的下标，最小值 $min(a_{1..n})$ 对应后面的下标：因为树状数组是后面的节点保存前面的节点的信息，而我们每次需要查询值大于等于当前 $a_i$ 的最大价值和的节点，所以需要将小的值的信息保存在后面节点， 大的值的信息保存在前面节点<br /></p>
  </li>
  <li>
    <p>查询：因为最大值为 $10000$，所以对于每次查询的 $a_i$，我们转换为下标 $10000-a_i+1$，然后查询 $[0,10000-a_i+1]$ 内的最大价值和，即查询了所有大于 $a_i$ 的节点的信息。 <br /></p>
  </li>
  <li>
    <p>更新：每次更新到当前位置 $i$ 的最大价值和，即需要更新所有小于 $a_i$ 的节点的最大价值和，对应更新树状数组中 $[10000-a_i+1, 10000]$ ，即当前值对应节点后面的所有节点：因为当前值的节点信息的更改只会影响到比它小的值的节点的信息，而树状数组前面节点信息的更改也只会影响到后面节点的信息。<br /></p>
  </li>
</ul>

<h2 id="ac-code-2">AC code</h2>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">MaxN</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="n">MaxN</span><span class="o">*</span><span class="mi">2</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">mid</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span><span class="n">num</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">BIT</span><span class="p">{</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tree</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
	<span class="kt">void</span> <span class="n">init</span><span class="p">(</span> <span class="kt">int</span> <span class="n">n</span> <span class="p">){</span>
		<span class="k">this</span><span class="o">-&gt;</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="p">;</span>
		<span class="n">CLR</span><span class="p">(</span><span class="n">tree</span><span class="p">);</span>
	<span class="p">}</span>
	
	<span class="kt">int</span> <span class="n">lowbit</span><span class="p">(</span> <span class="kt">int</span> <span class="n">x</span> <span class="p">){</span>
		<span class="k">return</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="p">(</span> <span class="o">-</span><span class="n">x</span> <span class="p">);</span>
	<span class="p">}</span>
	
	<span class="kt">int</span> <span class="n">getmax</span><span class="p">(</span> <span class="kt">int</span> <span class="n">n</span> <span class="p">){</span>
		<span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="p">;</span> <span class="n">i</span> <span class="o">-=</span> <span class="n">lowbit</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">){</span>
			<span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span> <span class="n">ans</span> <span class="p">,</span> <span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="kt">void</span> <span class="n">update</span><span class="p">(</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span> <span class="p">){</span>
		<span class="k">for</span><span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="n">lowbit</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span> <span class="p">){</span>
			<span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span> <span class="n">tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">,</span> <span class="n">val</span> <span class="p">)</span>  <span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span><span class="n">bit</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">Down</span><span class="p">[</span><span class="n">MaxN</span><span class="p">],</span><span class="n">Up</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">loc</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">bit</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>
    <span class="n">Down</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">loc</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">loc</span><span class="o">+</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">10000</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Down</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">Down</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">bit</span><span class="p">.</span><span class="n">getmax</span><span class="p">(</span><span class="mi">10000</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">Down</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Down</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">tmp</span><span class="p">);</span>
        <span class="n">bit</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="mi">10000</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">bit</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="mi">10000</span><span class="p">);</span>
    <span class="n">Up</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">loc</span><span class="o">+</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&gt;</span><span class="n">loc</span><span class="p">;</span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">10000</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Up</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">Up</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">bit</span><span class="p">.</span><span class="n">getmax</span><span class="p">(</span><span class="mi">10000</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">Up</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Up</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">loc</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">tmp</span><span class="p">);</span>
        <span class="n">bit</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="mi">10000</span><span class="o">-</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">tmp</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Down</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">Up</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">ans</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">i</span><span class="p">);</span>
            <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">c</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">10000</span><span class="p">)</span> <span class="n">mid</span><span class="p">[</span><span class="n">num</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">num</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ans</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">solve</span><span class="p">(</span><span class="n">mid</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
        <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ans</span><span class="o">+</span><span class="mi">10000</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="problem-g">Problem G</h2>

<p>Party 上有 $n$ 只青蛙，每只青蛙都有自己喜欢喝的茶：$1$ 表示喜欢喝红茶，$2$ 喜欢喝绿茶，$3$ 表示都喜欢。<br /></p>

<p>但同时有 $m$ 对青蛙之间有矛盾：不能给它们喝同样的茶，否则会打起来。同时，青蛙都喜欢宝石，如果给第 $i$ 只青蛙 $W_i$ 个宝石，它就不在乎矛盾了<br /></p>

<p>问最少需要花费多少宝石才能使得这些青蛙之间不会产生矛盾？<br /></p>

<p>数据范围：$ 1 ≤ n ≤ 10^3, 0 ≤ m ≤ 10^4, 1 ≤ W_i ≤ 10^6$ , 并且有矛盾的青蛙刚好可以被分成两个集合，集合中的青蛙互相间没有矛盾。<br /></p>

<h2 id="solution-3">Solution</h2>

<p>由于矛盾建图刚好是一个二分图，所以我们可以先将青蛙染色，分成两个内部无矛盾的集合 $A,B$，然后使用网络流来求解该题：<br /></p>

<p>首先我们将每只青蛙拆分成两个点，并且建边$i \rightarrow i’, W_i$。<br /></p>

<p>对于 $A$ 集合中的青蛙 $a_i$，如果它不喜欢红茶，我们建边 $S \rightarrow a_i, INF$；如果它不喜欢绿茶，我们建边 $a_i’ \rightarrow T, INF$。<br /></p>

<p>对于 $B$ 集合中的青蛙 $b_i$，如果它不喜欢红茶，我们建边 $b_i’ \rightarrow T, INF$；如果它不喜欢绿茶，我们建边 $S \rightarrow b_i, INF$。<br /></p>

<p>此时，整个图并不联通，如果集合 $A,B$ 之间无矛盾的话，那么我们就不用消除矛盾，原图的最小割也为0，答案也就是0。 <br /></p>

<p>但是，如果二分图中存在一条边 $a_i,b_i$，假如他们都不喜欢红茶，说明这两只不喜欢喝红茶的青蛙之间有矛盾，那么我们需要将它添加到网络流建图中，即建立 $a_i’ \rightarrow b_i, INF$，表示需要花费流量来消除这对矛盾<br /></p>

<p>这时，整个图就存在一条从 $S$ 到 $T$ 的边：$S \rightarrow a_i \rightarrow a_i’ \rightarrow b_i \rightarrow b_i’ \rightarrow T $，它的满流即 $a$ 和 $b$ 需要宝石的最小值，即对应消除矛盾的最小花费。<br /></p>

<p>所以，若对每一对矛盾在网络流中建图，最后的满流即最小割就对应消除这些矛盾的最小花费。</p>

<h2 id="ac-code-3">AC code</h2>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">cost</span><span class="p">[</span><span class="n">MaxN</span><span class="p">],</span> <span class="n">like</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="k">struct</span> <span class="n">EDGE</span><span class="p">{</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">next</span><span class="p">;}</span><span class="n">edge</span><span class="p">[</span><span class="n">MaxM</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">cont</span><span class="p">,</span><span class="n">head</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">void</span> <span class="kr">inline</span> <span class="nf">Add</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> 
<span class="p">{</span><span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">,</span> <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span> <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">cont</span><span class="o">++</span><span class="p">;</span> <span class="p">}</span>
<span class="kt">void</span> <span class="kr">inline</span> <span class="nf">ADD</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span> <span class="p">{</span> <span class="n">Add</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">),</span> <span class="n">Add</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);}</span>
<span class="kt">int</span> <span class="n">col</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">BFS</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">queue</span><span class="o">&lt;</span> <span class="kt">int</span> <span class="o">&gt;</span> <span class="n">Q</span><span class="p">;</span>
    <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
    <span class="n">col</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="c1">//debug(u)
</span>        <span class="n">u</span> <span class="o">=</span> <span class="n">Q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
        <span class="n">Q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">i</span><span class="o">!=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">col</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">col</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">^</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">color</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">cont</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">MST</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="o">&amp;</span><span class="n">b</span><span class="p">);</span>
        <span class="n">ADD</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">MST</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span> <span class="n">BFS</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">cal</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">G</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">S</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">like</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span> <span class="n">G</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">INF</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">like</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">2</span><span class="p">))</span> <span class="n">G</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">INF</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">like</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">2</span><span class="p">))</span> <span class="n">G</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">INF</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">like</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">))</span> <span class="n">G</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">INF</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">u</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">u</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">G</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="n">cost</span><span class="p">[</span><span class="n">u</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">i</span><span class="o">!=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
            <span class="n">G</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">u</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">INF</span><span class="p">);</span>
            <span class="c1">//cout &lt;&lt; u &lt;&lt; v &lt;&lt; endl;
</span>        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">LL</span> <span class="n">ans</span> <span class="o">=</span> <span class="n">G</span><span class="p">.</span><span class="n">MaxFlow</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">T</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ans</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">color</span><span class="p">();</span>
    <span class="n">cal</span><span class="p">();</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cost</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">like</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="n">solve</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="problem-h">Problem H</h2>

<p>给出一个长度为 $n$ 的排列 $P_{1…n}$，其中有 $m_1+m_2$ 条记录：$(a_i, b_i, c_i)$ <br /></p>

<ul>
  <li>
    <p>前 $m_1$ 条表示 $[a_i, b_i]$ 的最小值为 $c_i$。</p>
  </li>
  <li>
    <p>前 $m_2$ 条表示 $[a_i, b_i]$ 的最大值为 $c_i$。</p>
  </li>
</ul>

<p>输出满足条件的最小字典序的排列。</p>

<p>数据范围：$ 1 ≤ n ≤ 50, 0 ≤ m_1+m_2 ≤ 50$ <br /></p>

<h2 id="solution-4">Solution</h2>

<p>如果不管最小字典序，那么这个题就是一个二分图匹配，求出一个 $1-n$ 到 $1-n$ 的满足条件的完备匹配即可。
对于最小字典序，由于 $n$ 的范围很小，所以我们可以枚举 $1-n$ 的每个位置看能否用一个更小的数来匹配。</p>

<h2 id="ac-code-4">AC code</h2>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m1</span><span class="p">,</span><span class="n">m2</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">Min</span><span class="p">[</span><span class="mi">55</span><span class="p">],</span><span class="n">Max</span><span class="p">[</span><span class="mi">55</span><span class="p">],</span><span class="n">L</span><span class="p">[</span><span class="mi">55</span><span class="p">],</span><span class="n">R</span><span class="p">[</span><span class="mi">55</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">G</span><span class="p">[</span><span class="mi">55</span><span class="p">][</span><span class="mi">55</span><span class="p">],</span><span class="n">matching</span><span class="p">[</span><span class="mi">55</span><span class="p">];</span>
<span class="kt">bool</span> <span class="n">check</span><span class="p">[</span><span class="mi">55</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">ans</span><span class="p">[</span><span class="mi">55</span><span class="p">];</span>
<span class="kt">bool</span> <span class="nf">DFS</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">v</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">v</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">u</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="p">{</span>  
            <span class="n">check</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">matching</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">DFS</span><span class="p">(</span><span class="n">matching</span><span class="p">[</span><span class="n">v</span><span class="p">]))</span> 
            <span class="p">{</span>
                <span class="n">matching</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">;</span>
                <span class="n">ans</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span> 
<span class="p">}</span>
<span class="kt">int</span> <span class="n">pipi</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">Hungarian</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">pipi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>       
    <span class="n">MST</span><span class="p">(</span><span class="n">matching</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">u</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">u</span><span class="o">++</span><span class="p">)</span>  
    <span class="p">{</span>
        <span class="n">CLR</span><span class="p">(</span><span class="n">check</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">DFS</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
            <span class="n">pipi</span><span class="o">++</span><span class="p">;</span>       
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">init</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">CLR</span><span class="p">(</span><span class="n">G</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Max</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">n</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m2</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">init</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">m1</span><span class="o">--</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">);</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">b</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">Min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">Min</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">);</span>
            <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">a</span><span class="p">);</span> <span class="n">R</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">b</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">m2</span><span class="o">--</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">c</span><span class="p">);</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">b</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">Max</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">Max</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">);</span>
            <span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">a</span><span class="p">);</span> <span class="n">R</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">b</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">Min</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">Max</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">i</span> <span class="o">&amp;&amp;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
                <span class="p">{</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">Hungarian</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    
        <span class="k">if</span><span class="p">(</span><span class="n">pipi</span><span class="o">!=</span><span class="n">n</span><span class="p">)</span> <span class="n">puts</span><span class="p">(</span><span class="s">"-1"</span><span class="p">);</span>
        <span class="k">else</span>
        <span class="p">{</span>            
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">matching</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>   
                <span class="n">CLR</span><span class="p">(</span><span class="n">check</span><span class="p">);</span>
                <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">v</span><span class="o">&lt;</span><span class="n">x</span><span class="p">;</span><span class="n">v</span><span class="o">++</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span><span class="p">(</span><span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">v</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">check</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
                    <span class="p">{</span>  
                        <span class="n">check</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span> 
                        <span class="k">if</span><span class="p">(</span><span class="n">matching</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">DFS</span><span class="p">(</span><span class="n">matching</span><span class="p">[</span><span class="n">v</span><span class="p">]))</span>
                        <span class="p">{</span>
                            <span class="n">matching</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                            <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">;</span>
                            <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
                            <span class="k">break</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
                <span class="p">{</span>
                    <span class="n">G</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="n">matching</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="n">G</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%d%c"</span><span class="p">,</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">i</span><span class="o">==</span><span class="n">n</span><span class="o">?</span><span class="sc">'\n'</span><span class="o">:</span><span class="sc">' '</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="problem-i">Problem I</h2>

<p>给出一个 $N$ 个点的完全图，其中有 $m$ 条边的边权为 $a$，其他的边边权为 $b$。求 $1$ 到 $n$ 的最短路。<br /></p>

<p>数据范围：$ 2 ≤ n ≤ 10^5, 0 ≤ m ≤ 5\times 10^5, 1 \leq a, b \leq 10^9$ <br /></p>

<h2 id="solution-5">Solution</h2>

<p>分两种情况：<br /></p>

<ul>
  <li>
    <p>$ (1,n)$ 边权为 $b$，那么如果 $b \leq a$，最短路就是 $b$；否则我们需要判断是否存在一条从 $1$ 到 $n$ 的全由 $a$ 构成的路径使得最短路小于 $b$，因为 $a$ 边不多，所以这一步最短路算法或 $BFS$ 即可解决；<br /></p>
  </li>
  <li>
    <p>$ (1,n)$ 边权为 $a$，那么如果 $a \leq b$，最短路就是 $a$；否则我们需要判断是否存在一条从 $1$ 到 $n$ 的全由 $b$ 构成的路径使得最短路小于 $a$，虽然图是完全图，但是每个点都只会被用来松弛一次，所以我们可以用 $set$ 来维护一个下次可能用来松弛的点集，走一遍 $BFS$ 即可。<br /></p>
  </li>
</ul>

<h2 id="ac-code-5">AC code</h2>

<figure class="highlight"><pre><code class="language-c--" data-lang="c++"><span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
<span class="n">LL</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">Edge</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">next</span><span class="p">;</span>
    <span class="n">LL</span> <span class="n">w</span><span class="p">;</span>
<span class="p">}</span><span class="n">edge</span><span class="p">[</span><span class="n">MaxM</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">cont</span><span class="p">,</span> <span class="n">head</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="kt">int</span> <span class="n">v</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">u</span> <span class="o">=</span> <span class="n">u</span><span class="p">,</span> <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span> <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">w</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">edge</span><span class="p">[</span><span class="n">cont</span><span class="p">].</span><span class="n">next</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">cont</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="n">LL</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">pii</span><span class="p">;</span> 
<span class="k">struct</span> <span class="n">cmp</span>
<span class="p">{</span>                       
    <span class="kt">bool</span> <span class="k">operator</span><span class="p">()(</span><span class="n">pii</span> <span class="n">a</span><span class="p">,</span><span class="n">pii</span> <span class="n">b</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">first</span><span class="o">&gt;</span><span class="n">b</span><span class="p">.</span><span class="n">first</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="kt">bool</span> <span class="n">vis</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>
<span class="n">LL</span> <span class="n">dis</span><span class="p">[</span><span class="n">MaxN</span><span class="p">];</span>  
<span class="kt">void</span> <span class="nf">Dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">CLR</span><span class="p">(</span><span class="n">vis</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
    <span class="n">dis</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">pii</span><span class="p">,</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">pii</span><span class="o">&gt;</span><span class="p">,</span><span class="n">cmp</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">));</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">pii</span> <span class="n">u</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">if</span><span class="p">(</span><span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">.</span><span class="n">second</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
        <span class="n">vis</span><span class="p">[</span><span class="n">u</span><span class="p">.</span><span class="n">second</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">.</span><span class="n">second</span><span class="p">];</span><span class="n">i</span><span class="o">!=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">to</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
            <span class="c1">//debug((u.first + edge[i].w))
</span>            <span class="k">if</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">u</span><span class="p">.</span><span class="n">first</span> <span class="o">+</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dis</span><span class="p">[</span><span class="n">to</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">first</span> <span class="o">+</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">w</span><span class="p">;</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">make_pair</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">to</span><span class="p">],</span> <span class="n">to</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">min</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">));</span>
<span class="p">}</span>
<span class="n">set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">sa</span><span class="p">,</span> <span class="n">sb</span><span class="p">;</span>
<span class="n">set</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">it</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">BFS</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">sa</span><span class="p">.</span><span class="n">clear</span><span class="p">(),</span><span class="n">sb</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">dis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">INF</span><span class="p">,</span><span class="n">sb</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
    <span class="n">dis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">u</span> <span class="o">=</span> <span class="n">Q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
        <span class="n">Q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="n">i</span><span class="o">!=-</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">next</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">v</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">sb</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">sb</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
            <span class="n">sa</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span> <span class="k">auto</span> <span class="n">v</span> <span class="o">:</span> <span class="n">sb</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">dis</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">dis</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">sb</span><span class="p">.</span><span class="n">swap</span><span class="p">(</span><span class="n">sa</span><span class="p">);</span>
        <span class="n">sa</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">min</span><span class="p">(</span><span class="n">dis</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">));</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">init</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MST</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%lld%lld"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">init</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span>    
        <span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">u</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">u</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">v</span><span class="o">==</span><span class="n">n</span> <span class="o">||</span> <span class="n">u</span><span class="o">==</span><span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">v</span><span class="o">==</span><span class="mi">1</span>  <span class="p">)</span> <span class="n">flag</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
            <span class="n">add</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">),</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&lt;=</span><span class="n">a</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
            <span class="k">else</span> <span class="n">Dijkstra</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span> 
        <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="o">&lt;=</span><span class="n">b</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">a</span><span class="p">);</span>
            <span class="k">else</span> <span class="n">BFS</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="contest-summary">Contest Summary</h2>

<ul>
  <li>
    <p>记一次血崩的组队赛，三路开题，三路卡题</p>
  </li>
  <li>
    <p>需要加强组队配合，任务分配，并且规划一下训练内容了</p>
  </li>
</ul>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to drone - 以终为始，慎终如始。</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

                </section>
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/drone.png" alt="Drone" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/Drone">Drone</a></h4>
                                
                                    <p>The professional publishing platform</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/Drone">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                    /**
                    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
                    /*
                    var disqus_config = function () {
                    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
                    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                    };
                    */
                    (function() { // DON'T EDIT BELOW THIS LINE
                    var d = document, s = d.createElement('script');
                    s.src = 'https://akirakiwi.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                    })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/blog-cover.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; drone - 以终为始，慎终如始。 &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/algorithm/">Algorithm</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/LeetCode-Weekly-Contest-77">LeetCode Weekly Contest 77</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/WannaFly-Round-2-B">WannaFly Round #2 B</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/2015-SWERC-B">2015 Southwestern Europe Regional Contest (SWERC) B</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/algorithm/">
                                
                                    See all 31 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/2017-Multi-University-Training-Contest-3">
                <div class="post-card-image" style="background-image: url(/assets/images/stock/images-stock-photo-20170726.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/2017-Multi-University-Training-Contest-3">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Algorithm</span>
                            
                        
                    

                    <h2 class="post-card-title">2017 Multi-University Training Contest #3</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>## Contest Information source: [The 2017 Multi-University Training Contest #3 from HDU OJ](http://acm.hdu.edu.cn/search.php?field=problem&key=2017+Multi-University+Training+Contest+-+Team+3&source=1&searchmode=source) ## Problem C 给出一个序列 $A\_1, A\_2,.., A\_n $ ，定义 $f(l,r,k)$ 为 $A[l..r]$ 内的第 $k$ 大数，且 $k>r-l+1,f(l,r,k)=0$。给定 $k$，要求计算 $\\sum\_{l=1}^n \\sum\_{r=l}^n f(l,r,k)$</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/drone.png" alt="Drone" />
                        
                        <span class="post-card-author">
                            <a href="/author/Drone/">Drone</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/2017-Multi-University-Training-Contest-2">
                <div class="post-card-image" style="background-image: url(/assets/images/stock/images-stock-photo-20170726.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/2017-Multi-University-Training-Contest-2">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Algorithm</span>
                            
                        
                    

                    <h2 class="post-card-title">2017 Multi-University Training Contest #2</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>Contest Information source: The 2017 Multi-University Training Contest #2 from HDU OJ Problem F 函数 $F_{x,y}$ 满足： \[ F_{1,1} = F_{1,2} = 1 \\ F_{1,i} = F_{1,i-1} + 2\times F_{1,i-2} \ (i≥3) \\</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/drone.png" alt="Drone" />
                        
                        <span class="post-card-author">
                            <a href="/author/Drone/">Drone</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="http://localhost:4000/">
            
                <img src="/assets/images/favicon.png" alt="drone - 以终为始，慎终如始。 icon" />
            
            <span>drone - 以终为始，慎终如始。</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">四川省第七届大学生程序设计竞赛</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B&amp;url=https://jekyller.github.io/jasper2/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://jekyller.github.io/jasper2/%E5%9B%9B%E5%B7%9D%E7%9C%81%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%A4%A7%E5%AD%A6%E7%94%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%AB%9E%E8%B5%9B"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="http://localhost:4000/">drone</a> &copy; 2018</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a>
                </section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://facebook.com/username" target="_blank" rel="noopener">Facebook</a>
                    <a href="https://twitter.com/username" target="_blank" rel="noopener">Twitter</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
        <div id="subscribe" class="subscribe-overlay">
            <a class="subscribe-overlay-close" href="#"></a>
            <div class="subscribe-overlay-content">
                
                    <img class="subscribe-overlay-logo" src="/assets/images/blog-icon.png" alt="drone - 以终为始，慎终如始。" />
                
                <h1 class="subscribe-overlay-title">Subscribe to drone - 以终为始，慎终如始。</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest &amp; greatest posts delivered straight to your inbox</p>
                <form method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  /><input class="location" type="hidden" name="location"  /><input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" type="email" name="email"  placeholder="youremail@example.com" />
    </div>
    <button class="" type="submit" disabled><span>Subscribe</span></button>
    <script type="text/javascript">(function(g,h,o,s,t){h[o]('.location')[s]=h[o]('.location')[s] || g.location.href;h[o]('.referrer')[s]=h[o]('.referrer')[s] || h.referrer;})(window,document,'querySelector','value');</script>
</form>

            </div>
        </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113198900-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
